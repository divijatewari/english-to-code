<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>English → Code (Demo)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0f1724;--card:#0b1220;--muted:#95a1b8;--accent:#6ee7b7}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071028 0%,#0f1724 100%);color:#e6eef6}
  .container{max-width:920px;margin:36px auto;padding:28px;background:linear-gradient(180deg,#071028cc,#071028aa);border-radius:14px;box-shadow:0 10px 30px rgba(2,6,23,.6)}
  h1{margin:0 0 8px;font-size:28px}
  p.lead{margin:0 0 18px;color:var(--muted)}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  textarea,input,select{width:100%;padding:12px;border-radius:10px;border:1px solid #132033;background:#061021;color:#e6eef6;box-sizing:border-box}
  .controls{display:grid;grid-template-columns:1fr 180px;gap:12px;margin-top:12px}
  button{background:var(--accent);border:none;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
  button.ghost{background:transparent;border:1px solid #203248;color:var(--accent)}
  pre{background:#041322;color:#bfeadf;padding:14px;border-radius:10px;overflow:auto;white-space:pre-wrap}
  .meta{display:flex;justify-content:space-between;align-items:center;margin-top:8px;color:var(--muted);font-size:13px}
  .examples{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
  .chip{background:#071b2a;padding:8px 10px;border-radius:999px;border:1px solid #083048;cursor:pointer;color:var(--muted)}
  .result-title{margin:18px 0 6px;font-weight:600}
  .footer{margin-top:20px;color:var(--muted);font-size:14px}
  .copybtn{float:right;background:transparent;border:0;color:var(--muted);cursor:pointer}
  @media(max-width:640px){.controls{grid-template-columns:1fr}}
</style>
</head>
<body>
  <div class="container" role="main">
    <h1>English → Code — Demo</h1>
    <p class="lead">Type a coding request in plain English and get a runnable code snippet. This is a demo using a local generator — production LLM integration available.</p>

    <label for="input">Describe what you want (e.g. "Find maximum in a list")</label>
    <textarea id="input" rows="4" placeholder="e.g. Merge two sorted arrays"></textarea>

    <div class="controls">
      <select id="language">
        <option value="python">Python</option>
        <option value="javascript">JavaScript</option>
        <option value="java">Java</option>
        <option value="cpp">C++</option>
      </select>

      <div style="display:flex;gap:8px">
        <button id="runBtn">Generate</button>
        <button id="liveBtn" class="ghost">Try PRO (Gemini)</button>
      </div>
    </div>

    <div class="meta">
      <div>
        <strong>Quick examples:</strong>
        <div class="examples" id="examples">
          <!-- chips populated by JS -->
        </div>
      </div>
      <div style="text-align:right">
        <small>Demo mode • no API key needed</small>
      </div>
    </div>

    <div id="status" style="margin-top:10px;color:var(--muted)"></div>

    <div class="result-title">Result</div>
    <div style="display:flex;align-items:flex-start;gap:12px">
      <pre id="output" aria-live="polite">Your generated snippet will appear here.</pre>
      <div style="min-width:90px">
        <button id="copyBtn" class="copybtn">Copy</button>
        <div style="height:10px"></div>
        <button id="downloadBtn" class="ghost">Download .txt</button>
      </div>
    </div>

    <div class="footer">
      <p><strong>Note:</strong> This demo uses a deterministic local generator (good for interviews / offline demos). A live LLM-powered endpoint can be integrated later without changing the UI.</p>
    </div>
  </div>

<script>
// ---------- Local generator database ----------
const SNIPPETS = [
  { id:"max-list", patterns:["max","maximum","largest number","largest"], languages:{
      python: "def find_max(arr):\n    return max(arr)\n\nprint(find_max([1,3,2]))",
      javascript: "function findMax(arr){ return Math.max(...arr); }\nconsole.log(findMax([1,3,2]));",
      java: "public static int findMax(int[] a){ int m=a[0]; for(int v:a) if(v>m) m=v; return m; }",
      cpp: "int findMax(vector<int>& a){ int m=a[0]; for(int v:a) if(v>m) m=v; return m; }"
  }, explain:"Use built-in max/Math.max or simple loop (O(n))." },

  { id:"reverse-string", patterns:["reverse string","reverse a string","reverse"], languages:{
      python: "s='hello'\nprint(s[::-1])",
      javascript: "const s='hello'; console.log(s.split('').reverse().join(''));",
      java: "String s = \"hello\"; System.out.println(new StringBuilder(s).reverse().toString());",
      cpp: "#include <algorithm>\nstring s=\"hello\"; reverse(s.begin(), s.end()); cout<<s;"
  }, explain:"Reverse by slicing (Python) or split+reverse (JS)." },

  { id:"two-sum", patterns:["two sum","two-sum","pair with sum","find two numbers that add"], languages:{
      python: "def two_sum(nums, target):\n    seen = {}\n    for i, v in enumerate(nums):\n        if target - v in seen:\n            return [seen[target - v], i]\n        seen[v] = i\n    return []",
      javascript: "function twoSum(nums, target){ const seen = new Map(); for(let i=0;i<nums.length;i++){ const c=target-nums[i]; if(seen.has(c)) return [seen.get(c), i]; seen.set(nums[i], i);} return []; }",
      java: "// Two-sum uses hashmap; implementation omitted for brevity",
      cpp: "// Two-sum using unordered_map; implementation omitted for brevity"
  }, explain:"Hashmap stores previously seen values; O(n) time." },

  { id:"binary-search", patterns:["binary search","binary"], languages:{
      python: "def binary_search(arr, target):\n    l, r = 0, len(arr)-1\n    while l<=r:\n        mid=(l+r)//2\n        if arr[mid]==target: return mid\n        if arr[mid]<target: l = mid+1\n        else: r = mid-1\n    return -1",
      javascript: "function binarySearch(arr,target){let l=0,r=arr.length-1;while(l<=r){let m=Math.floor((l+r)/2);if(arr[m]===target) return m; if(arr[m]<target) l=m+1; else r=m-1;} return -1}",
      java: "// Binary search implementation omitted",
      cpp: "// Binary search implementation omitted"
  }, explain:"Search a sorted array in O(log n)." },

  { id:"factorial", patterns:["factorial","n!","factorial of"], languages:{
      python: "def fact(n):\n    return 1 if n<=1 else n*fact(n-1)\n\nprint(fact(5))",
      javascript: "function fact(n){ return n<=1?1:n*fact(n-1); } console.log(fact(5));",
      java: "long fact(int n){ long res=1; for(int i=2;i<=n;i++) res*=i; return res; }",
      cpp: "long long fact(int n){ long long r=1; for(int i=2;i<=n;i++) r*=i; return r; }"
  }, explain:"Recursive or iterative factorial (works for small n)." },

  { id:"palindrome", patterns:["palindrome","is palindrome"], languages:{
      python: "def is_pal(s):\n    s=''.join(ch for ch in s.lower() if ch.isalnum())\n    return s==s[::-1]\nprint(is_pal('A man, a plan, a canal'))",
      javascript: "function isPal(s){ s=s.toLowerCase().replace(/[^a-z0-9]/g,''); return s===s.split('').reverse().join(''); }",
      java: "// Palindrome example omitted",
      cpp: "// Palindrome example omitted"
  }, explain:"Normalize and compare with reversed string." }
];

// build examples list
const EXAMPLES = [
  "Find maximum in a list",
  "Reverse a string",
  "Two-sum problem",
  "Binary search in sorted array",
  "Compute factorial of n",
  "Check if palindrome"
];

// ---------- Utilities ----------
function normalize(s){ return (s||"").toLowerCase().replace(/[^a-z0-9\s]/g,' ').trim(); }

function findBestSnippet(input){
  const t = normalize(input);
  if(!t) return null;
  // score each snippet by pattern matches and keyword overlap
  let best=null, bestScore=0;
  for(const item of SNIPPETS){
    let score=0;
    for(const p of item.patterns){
      if(t.includes(p)) score += 30;
    }
    // partial overlap tokens
    const toks = new Set(t.split(/\s+/));
    for(const p of item.patterns){
      for(const w of p.split(/\s+/)){
        if(toks.has(w)) score += 3;
      }
    }
    if(score>bestScore){ bestScore=score; best=item; }
  }
  // threshold
  if(bestScore < 6) return null;
  return best;
}

// ---------- UI wiring ----------
const input = document.getElementById('input');
const language = document.getElementById('language');
const runBtn = document.getElementById('runBtn');
const output = document.getElementById('output');
const status = document.getElementById('status');
const examplesDiv = document.getElementById('examples');
const copyBtn = document.getElementById('copyBtn');
const downloadBtn = document.getElementById('downloadBtn');
const liveBtn = document.getElementById('liveBtn');

EXAMPLES.forEach(e=>{
  const chip=document.createElement('button'); chip.className='chip'; chip.textContent=e;
  chip.onclick=()=>{ input.value=e; runGenerator(); }
  examplesDiv.appendChild(chip);
});

copyBtn.onclick = ()=>{
  navigator.clipboard.writeText(output.textContent).then(()=>{ status.textContent='Copied to clipboard'; setTimeout(()=>status.textContent='',1200); });
};
downloadBtn.onclick = ()=>{
  const blob = new Blob([output.textContent], {type:'text/plain'});
  const a = document.createElement('a'); a.download = 'snippet.txt'; a.href = URL.createObjectURL(blob); a.click();
};

liveBtn.onclick = ()=>{
  alert("PRO version (Gemini-backed) is coming soon. For now this demo uses a local generator. When live, the PRO button will call the secure server-side endpoint.");
};

async function runGenerator(){
  const text = input.value.trim();
  if(!text){ status.textContent='Please type a request.'; return; }
  status.textContent='Generating (local engine)…';
  output.textContent = 'Working…';

  // local pattern matching
  const best = findBestSnippet(text);
  const lang = language.value || 'python';
  if(best){
    const code = (best.languages[lang] || best.languages['python']) || "// snippet not available in this language";
    output.textContent = code + "\n\n// Explanation: " + (best.explain || '');
    status.textContent = 'Result from local generator';
    return;
  }

  // fallback simple heuristics: common tasks via quick templates
  const t = normalize(text);
  if(t.includes('sort') && t.includes('array')){
    if(lang==='python') output.textContent = "arr = [3,1,2]\narr.sort()\nprint(arr)";
    else if(lang==='javascript') output.textContent = "const arr=[3,1,2]; arr.sort((a,b)=>a-b); console.log(arr);";
    else output.textContent = "// Sort example omitted for this language";
    status.textContent='Result from simple template';
    return;
  }

  // generic fallback
  output.textContent = "# Sorry — no direct local match.\n# Try: 'Find maximum in a list' or choose one of the examples above.";
  status.textContent = 'No local match — refine your request';
}

// handle button
runBtn.onclick = runGenerator;

// prettify initial placeholder
output.textContent = "Try an example above (click one) or type: 'Find maximum in a list'";

// allow ctrl+enter to run
input.addEventListener('keydown', (e)=>{ if(e.ctrlKey && e.key==='Enter') runGenerator(); });

</script>
</body>
</html>
